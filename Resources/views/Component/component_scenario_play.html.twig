{% extends "GXHomeAutomationBundle:Component:component_base.html.twig" %}

{% block html_content %}
	<md-button class="md-raised md-primary component-button" flex
			   ng-disabled="{% if component.getForeignId1 is null %}true{% else %}(button.state == 1){% endif %}"
			   layout="row" layout-align="start center" ng-class="{'md-accent': (button.state == 3)}"
			   ng-click="button.scenarioPlay()">
		<div flex="15"> <small>[icon]</small> </div>
		<div flex layout="column">
			<div flex>
				{{ component.title }}
			</div>
			{% if component.description %}
				<div flex class="description" style="text-overflow: ellipsis">
					{{ component.description }}
				</div>
			{% endif %}
		</div>
		<div class="timer" flex="10" style="min-height:4em;font-size:0.5em;padding-top:3em;"
			 ng-class="{
				'progress' : (button.state == 1),
				'delay' : (button.state == 2),
				'active': (button.state == 3),
				'error' : (button.state == -1)
			}">
		</div>
	</md-button>
{% endblock %}


{% block controller_script %}
	$scope.button = {
		state: 1, {# TODO !3: controlleur angular pour ce component... #}
		scenarioPlay: function() {
			console.log('PLAY '+{{ component.id }}+' TODO');
		}
	};
{% endblock %}


{% block configure_html_content %}
	<form name="componentForm" layout="column" flex layout-fill>
		<section>
			<md-subheader class="md-accent">Scenario Play</md-subheader>
			<md-list layout="column" layout-padding>
				<md-list-item>
					<md-input-container flex>
						<label>Title</label>
						<input ng-model="component.title" required name="component_title" md-maxlength="98" />
					</md-input-container>
				</md-list-item>
				<md-list-item>
					<md-input-container flex>
						<label>{# TODO !108: icon support #}</label>
					</md-input-container>
				</md-list-item>
				<md-list-item>
					<md-input-container flex>
						<label>Description</label>
						<textarea ng-model="component.description" columns="1" md-maxlength="482"></textarea>
					</md-input-container>
				</md-list-item>
				<md-list-item>
					<md-select placeholder="Scenario linked" ng-model="component.foreign_id_1" md-on-open="myfox.loadScenarii()" flex>
						<md-option ng-value="scenario.scenarioId" ng-repeat="scenario in myfox.onDemandScenarii">{{ '{{' }}scenario.label{{ '}}' }}</md-option>
					</md-select>
				</md-list-item>
				<md-list-item>
					<md-input-container flex>
						<label>Delayed play action (in minutes)</label>
						<input required type="number" step="any" name="component_delay" ng-model="component.delay_1" min="0" max="1440" required>
						<div ng-messages="componentForm.component_delay.$error">
							<div ng-message="required">If you want immediate play action, please indicate 0.</div>
							<div ng-message="min">Impossible to go back in time, Marty!</div>
							<div ng-message="max">1440 minutes max. Equivalent to 24hrs.</div>
						</div>
					</md-input-container>
				</md-list-item>
			</md-list>
		</section>
		<md-divider></md-divider>
		<section>
			<md-subheader class="md-warn">Options</md-subheader>
			{# TODO !0: fin du form a reprendre depuis component_edit_scenario_play.html.twig #}
		</section>
	</form>
{% endblock %}
